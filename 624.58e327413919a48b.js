"use strict";(self.webpackChunkmeddler_genz_ui=self.webpackChunkmeddler_genz_ui||[]).push([[624],{2624:(Q,O,c)=>{c.d(O,{Ww:()=>G,Gq:()=>h,uU:()=>I,G:()=>x});var v=c(7048),j=c(3800),k=c(2700),b=c(6700),W=c(8960),p=c(4704),q=c(7680),U=c(7400),w=c(5568),d=c(9212),A=c(7368),N=c(9144),E=c(8716),P=c(5084),B=c(6684),L=c(4e3),$=c(6716),y=c(7724),D=c(4496),H=c(6588);function I(l){const f=l.replace("#","");return.2126*parseInt(f.substring(0,2),16)+.7152*parseInt(f.substring(2,4),16)+.0722*parseInt(f.substring(4,6),16)>128}function h(l){let f=0;for(let s=0;s<l.length;s++)f=l.charCodeAt(s)+((f<<5)-f);return"#"+(Math.abs(f)%16777216).toString(16).padStart(6,"0")}const x=0;let G=(()=>{class l{assignResourcesToEngagement(e,t,s=!1){return s?this.deleteRequest(`api/v1/devsecops/resources/${e}/${t}`).pipe():this.putRequest(`api/v1/devsecops/resources/${e}/${t}`).pipe()}getCWE(e){return this.getRequest("api/v1/devsecops/cwe",{query:e}).pipe()}getParsers(e){return this.getRequest("api/v1/devsecops/internal/meta-data/ingest/parser/dojo",{query:e}).pipe()}getCWEById(e){return this.getRequest(`api/v1/devsecops/cwe/${e}`,{}).pipe()}getResourcesForEngagement(e){return this.getRequest(`api/v1/devsecops/resources/${e}`).pipe((0,p.k)(t=>t?.data),(0,p.k)(t=>t.map(s=>(s.primary_color=h(s.email),s))))}getResources(){return this.getRequest("api/v1/devsecops/resources").pipe((0,p.k)(e=>e?.data),(0,p.k)(e=>e.map(t=>(t.primary_color=h(t.email),t.text_color=I(t.primary_color),t))))}getTeamMembers(e){return this.getRequest(`api/v1/devsecops/team-members/${e}`).pipe((0,p.k)(t=>t?.data?.users),(0,p.k)(t=>t.map(s=>{let i=h(s);return{primary_color:i,text_color:I(i),email:s}})))}getApplications(e,t,s,i){return i<1&&(i=1),this.getRequest("api/v1/devsecops/app",{projectId:t,businessId:e,platform:s,page:i}).pipe((0,p.k)(r=>(r.data=r.data.map(a=>(a.primary_color=h(a.business_id.$oid),a)),r)))}moveFindingToDraft(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/draft/${t}`).pipe((0,p.k)(s=>s?.data))}moveFindingToPublish(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/publish/${t}`).pipe((0,p.k)(s=>s?.data))}markIssueToBeverified(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/mark-for-revalidation/${t}`).pipe((0,p.k)(s=>s?.data))}markMultipleIssueToBeverified(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/mark-for-revalidation`,t).pipe((0,p.k)(s=>s?.data))}unmarkMultipleIssueToBeverified(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/unmark-for-revalidation`,t).pipe((0,p.k)(s=>s?.data))}moveMultipleFindingsToDraft(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/draft`,t).pipe((0,p.k)(s=>s?.data))}moveMultipleFindingsToPublish(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/publish`,t).pipe((0,p.k)(s=>s?.data))}changeMultipleFindingsState(e,t,s){return this.putRequest(`api/v1/devsecops/engagement/${t}/finding/state/${e}`,s).pipe((0,p.k)(i=>i?.data))}unmarkIssueToBeverified(e,t){return this.deleteRequest(`api/v1/devsecops/engagement/${e}/mark-open/${t}`).pipe((0,p.k)(s=>s?.data))}updateEngagementState(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/state/${t}`).pipe((0,p.k)(s=>s?.status))}updateFindingState(e,t,s){return this.putRequest(`api/v1/devsecops/engagement/${e}/finding/${t}/state/${s}`).pipe()}updateFindingClaimState(e,t,s){return this.putRequest(`api/v1/devsecops/engagement/${e}/finding/${t}/claim-state/${s}`).pipe((0,p.k)(i=>i?.status))}getApplicationById(e){return e?this.getRequest(`api/v1/devsecops/app/${e}`).pipe((0,p.k)(t=>t?.data)):(0,j.c)(()=>{new Error("Invalid Application")})}editApplicationById(e,t){return e?this.putRequest(`api/v1/devsecops/app/${e}`,t).pipe((0,p.k)(s=>s?.status)):(0,j.c)(()=>{new Error("Invalid Application")})}getProjectById(e){return e?this.getRequest(`api/v1/devsecops/project/${e}`).pipe((0,p.k)(t=>t?.data)):(0,j.c)(()=>{new Error("Invalid Application")})}getBusinessById(e){return e?this.getRequest(`api/v1/devsecops/business/${e}`).pipe((0,p.k)(t=>t?.data)):(0,j.c)(()=>{new Error("Invalid Application")})}createSastEngagement(e,t,s){return this.postRequest("api/v1/devsecops/engagement/sast",{application_id:e,tags:t,description:s}).pipe()}createDastEngagement(e,t,s){return this.postRequest("api/v1/devsecops/engagement/dast",{application_id:e,tags:t,description:s}).pipe()}createPentestEngagement(e,t,s){return this.postRequest("api/v1/devsecops/engagement/pentest",{application_id:e,tags:t,description:s}).pipe()}createApplication(e,t,s,i){return this.postRequest(`api/v1/devsecops/app/${t}/${e}`,{title:s,description:i}).pipe((0,q.o)(this.mockDelay))}updateApplicationById(e,t,s){return this.putRequest(`api/v1/devsecops/app/${t}/${e}`,s).pipe((0,q.o)(this.mockDelay),(0,p.k)(i=>i?.data))}updateApplicationConfigById(e,t){return this.putRequest(`api/v1/devsecops/app/config/${e}`,t).pipe((0,q.o)(this.mockDelay),(0,p.k)(s=>s?.data))}updateFindingPush(e,t,s,i,r){return"step"==i?this.updateStepToFinding(e,t,s,r):this.updateImpactToFinding(t,s,r)}upload(e,t,s){let i="fileId";const r=new FormData;return r.append("files",e,e.name),new v.UD,this.http.post(this.localUrl+"/api/v1/devsecops/upload",r,{reportProgress:!0,observe:"events"}).pipe((0,p.k)(o=>{if(console.log("event.type",o.type),o.type===v.yc.UploadProgress){const u=Math.round(100*o.loaded/o.total);return(0,k.of)({progress:u,id:i,completed:!1})}if(o.type===v.yc.Response){let u=$.O.minio_url+o.body.files[0].presigned_url,m=o.body.files[0].data;return console.log("boommmeer",u),this.http.put(u,e,{withCredentials:!0}).pipe((0,p.k)(g=>this.updateApplicationById(t,s,{file:m}).pipe((0,p.k)(R=>(console.log("updateApplicationById",t,s,m,R),{progress:100,data:R,id:i,completed:!0})))),(0,U.O)(g=>g))}return console.log("event.type"),(0,k.of)({progress:100,completed:!1})}))}getFileList(){return this.fileList}_uploadNew(e){new v.UD;let s=[];for(let r=0;r<e.length;r++)s.push({filename:e.item(r).name});return this.http.post(this.localUrl+"/api/v1/devsecops/upload",{files:s}).pipe((0,p.k)(r=>r.files.map((n,o)=>this.http.put($.O.minio_url+n.presigned_url,e.item(o),{reportProgress:!0,observe:"events",withCredentials:!0}).pipe((0,w.W)({progress:1,completed:!1,init:!0})).pipe(this.uploadProgressPipeAndLinker(n)))),(0,d.y)(r=>{console.log("major task done",r)})).pipe((0,d.y)(r=>{r.forEach(a=>{this.fileList.push(a)})}))}uploadNew(e,t){new v.UD;let i=[];for(let a=0;a<e.length;a++)i.push({filename:e.item(a).name});return this.http.post(this.localUrl+"/api/v1/devsecops/upload",{files:i}).pipe((0,p.k)(a=>a.files.map((u,m)=>this.http.put(u.presigned_url,e.item(m),{reportProgress:!0,observe:"events",withCredentials:!0}).pipe((0,w.W)({progress:1,completed:!1,init:!0}),this.uploadProgressPipeAndLinker(u,t))))).pipe((0,U.O)(a=>a),(0,d.y)(a=>{a.forEach(n=>{this.fileList.push(n)})}))}uploadProgressPipeAndLinker(e,t){let s=(i,r,a)=>(t=t?t(i):this.postRequest("/api/v1/devsecops/upload_linker",i),console.log("linkerFunc?: any","present",t),t.pipe((0,p.k)(n=>(console.log("upload_linker",n),1==n.status?r:a))));return i=>i.pipe((0,p.k)(r=>{if(console.log("event.type",r.type),r.type===v.yc.UploadProgress){const a=Math.round(100*r.loaded/r.total);return console.log("event.type.progress",a),(0,k.of)({progress:a,completed:!1,file_details:e?.data})}return r.type===v.yc.Response?(console.log("event_debug",r),200==r.status?(0,k.of)(void 0).pipe((0,A.G)(a=>s(e?.data,{progress:100,completed:!0,file_details:e?.data},{progress:0,completed:!1,file_details:e?.data}))):(0,k.of)({progress:0,completed:!1,file_details:e?.data})):(console.log("event.type"),(0,k.of)({progress:100,completed:!1,file_details:e?.data}))}),(0,A.G)(r=>r),(0,N.a)(r=>(console.error("Error in customProgressPipe:",r),(0,k.of)({progress:0,completed:!1,file_details:e?.data}))))}uploadToFinding(e,t,s,i,r,a){let n="fileId";const o=new FormData;return o.append("files",e,e.name),new v.UD,this.http.post(this.localUrl+"/api/v1/devsecops/upload",o,{reportProgress:!0,observe:"events"}).pipe((0,p.k)(g=>{if(console.log("event.type",g.type),g.type===v.yc.UploadProgress){const R=Math.round(100*g.loaded/g.total);return(0,k.of)({progress:R,id:n,completed:!1})}if(g.type===v.yc.Response){let R=$.O.minio_url+g.body.files[0].presigned_url,F=g.body.files[0].data;return console.log("boommmeer",R),this.http.put(R,e,{withCredentials:!0}).pipe((0,p.k)(C=>{let T={};return T[r]={file:F},this.updateFindingPush(t,s,i,a,T).pipe((0,p.k)(S=>({progress:100,data:S,id:n,completed:!0})))}),(0,U.O)(C=>C))}return console.log("event.type"),(0,k.of)({progress:100,completed:!1})}))}businessMaping(){return this.getRequest("api/v1/business/businessMaping",{}).pipe((0,p.k)(e=>e.data),(0,p.k)(e=>e.map(t=>(t.color=h(t._id.$oid),t.projects.map(s=>(s.color=h(s._id.$oid),s)),t))),(0,E.C)(1,1))}addAssetUrl(e,t){return this.putRequest("api/v1/business/assets/dns",{applicationId:t,domain:e})}removeAssetUrl(e,t){return this.deleteRequest("api/v1/business/assets/dns/"+t+"/"+e)}getAssetUrls(e){return this.getRequest("api/v1/business/assets/dns/"+e).pipe((0,p.k)(t=>(t?.data?.unshift({domain:"All",_id:{$oid:"*"}}),t?.data)))}getDiscoveredAssets(e,t=0,s="",i=3e3){return this.getRequest("api/v1/business/assets/dns/discovered/"+e,{last_val:t,search:s,limit:i}).pipe((0,p.k)(r=>r?.data))}getDiscoveredAllFilteredAssets(e,t=0,s="",i=30){return this.getRequest("api/v1/business/assets/dns/discovered/filtered/"+e,{last_val:t,search:s,limit:i}).pipe((0,p.k)(r=>r?.data))}deleteApplication(e){return this.getRequest("api/v1/customer/request/delete/"+e).pipe((0,p.k)(t=>t?.data))}editBusiness(e,t){return this.putRequest("api/v1/business/"+e,t)}editProject(e,t,s){return this.putRequest("api/v1/business/"+e+"/"+t,s)}createApp(e){return this.postRequest("api/v1/devsecops/create_app",e).pipe((0,p.k)(t=>t?.data))}buildDetailedPipe(e){let t="Unknown",s=0,i=e?.transition_state,r=e?.files?.map(o=>(o.download_url=this.downloadFile(o).pipe((0,p.k)(u=>(u.url=$.O.minio_url+u.url,console.log("__download_url",u),u.url)),(0,A.G)(u=>this.http.get(u,{responseType:"text"}))),console.log("download_url",o),o));e.files=r,i<=y.eC.FAILED?(t="Failed",s=0):i==y.eC.ENQUEUED?(t="Enqueued",s=5):i>=y.eC.EXECUTION_ENQUEUED&&i<=y.eC.EXECUTION_REPORT_DOWNLOADED?(t="Executing",s=25):i>=y.eC.PARSING_ENQUEUED&&i<=y.eC.PARSING_STARTED?(t="Parsing",s=75):i>=y.eC.PARSING_FINISHED&&(t="Completed",s=100);let a="loader-outline",n="primary";return 0==i?(a="close-outline",n="danger"):8==i&&(a="checkmark-outline",n="success"),e.buildState=t,e.buildProgress=s,e.buildProgress=Math.ceil(i/8*100),e.progressIcon=a,e._status=n,e}selectApp(e){console.log("selectApp",e),this.selectedApp$.next(e)}selectProject(e,t){this.selectedBusiness.pipe((0,P.K)(),(0,d.y)(s=>{this.selectedProject$.next(s?.project[e])})).subscribe(s=>{t&&t()})}selectBusiness(e,t){this.appHier.pipe((0,P.K)(),(0,d.y)(s=>{this.selectedBusiness$.next(s[e])})).subscribe(s=>{this.selectProject(0,t)})}getPlatforms(){return this.getRequest("api/v1/customer/items/platform").pipe((0,p.k)(e=>e?.data))}getUserApplication(e){return 1==e?.integrated||0==e?.integrated||delete e.integrated,1!=e?.includeOffsetId&&delete e.includeOffsetId,this.getRequest("api/v1/customer/getUserApplication",e)}getUserApplicationById(e){return this.getRequest("api/v1/customer/getUserApplication/"+e).pipe((0,d.y)(t=>{0==t?.status&&this.router.navigate(["/","devsec","switch"])}),(0,p.k)(t=>t?.data))}getDevsecopsBuildData(e,t){return this.postRequest("api/v1/devsecops/build",e,t).pipe((0,p.k)(s=>s?.data))}getBusinesses(){return this.getRequest("api/v1/business/?limit=9999999999").pipe((0,p.k)(e=>e?.data))}getExternalTools(){return this.getRequest("api/v1/devsecops/getExternalToolsList").pipe((0,p.k)(e=>e?.data.map(t=>t)))}getExternalDevSecTools(){return this.getRequest("api/v1/devsecops/getExternalDevToolsList").pipe((0,p.k)(e=>e?.data))}runExtetnalTool(e){return this.postRequest("api/v1/devsecops/runAdhocExternalTools",e).pipe((0,p.k)(t=>t?.data))}runExtetnalToolNew(e){return this.postRequest("api/v1/devsecops/runAdhocExternalToolsNew",e).pipe((0,p.k)(t=>t?.data))}getProjects(){return this.getRequest("api/v1/user/project/").pipe((0,p.k)(e=>e?.data))}suppressFindingById(e,t){return this.postRequest(`api/v1/devsecops/finding/suppress/${e}`,t)}resetStateFindingById(e,t){return this.postRequest(`api/v1/devsecops/finding/reset_state/${e}`,t)}acceptRiskFindingById(e,t){return this.postRequest(`api/v1/devsecops/finding/accept_risk/${e}`,t)}getFindingById(e){return this.getRequest(`api/v1/devsecops/finding/fetch/${e}`)}createFinding(e,t){return this.postRequest(`api/v1/devsecops/engagement/${e}/finding`,t)}updateFinding(e,t,s){return this.putRequest(`api/v1/devsecops/engagement/${e}/finding/${t}`,s)}addStepToFinding(e,t,s){return this.postRequest(`api/v1/devsecops/engagement/${e}/finding/${t}/step`,s)}addImpactToFinding(e){return this.postRequest(`api/v1/devsecops/engagement/${e}/finding/impact`)}getStepToFinding(e,t,s){return this.getRequest(`api/v1/devsecops/engagement/${e}/finding/${t}/step/${s}`).pipe((0,p.k)(i=>i?.data))}deleteStepToFinding(e,t,s){return this.deleteRequest(`api/v1/devsecops/engagement/${e}/finding/${t}/step/${s}`).pipe((0,p.k)(i=>i))}getImpactById(e,t){return this.getRequest(`api/v1/devsecops/engagement/${e}/finding/impact/${t}`).pipe((0,p.k)(s=>s?.data))}updateStepToFinding(e,t,s,i){return this.putRequest(`api/v1/devsecops/engagement/${e}/finding/${t}/step/${s}`,i).pipe((0,q.o)(this.mockDelay))}updateImpactToFinding(e,t,s){return this.putRequest(`api/v1/devsecops/engagement/${e}/finding/impact/${t}`,s).pipe((0,q.o)(this.mockDelay))}stopBuildScan(e,t){return this.postRequest(`api/v1/devsecops/build/stop/${e}/${t}`).pipe((0,p.k)(s=>s?.data))}stopAllPrevious(e,t){return this.postRequest(`api/v1/devsecops/build/stop/allprevious/${e}/${t}`).pipe((0,p.k)(s=>s?.data))}getBuildByIds(e,t,s){return this.postRequest("api/v1/devsecops/builds",{build_ids:e,build_top_offset:t,filters:s}).pipe((0,p.k)(i=>i?.data))}getBuildById(e){return this.postRequest(`api/v1/devsecops/build/${e}`).pipe((0,p.k)(t=>t?.data))}getAssessmentsFindingsById(e){return this.getRequest(`api/v1/devsecops/beta_findings/${e}`)}getSignalFindingsById(e){return this.getRequest(`api/v1/devsecops/signal/findings/${e}`)}getApplicationWideFindings(e,t,s,i=1){return this.getRequest(`api/v1/devsecops/application/${e}/findings/${t}`,{page:i,finding_state:s}).pipe((0,d.y)(r=>{console.log(r)}))}getBusinessWideFindings(e,t,s,i=1){return this.getRequest(`api/v1/devsecops/business/${e}/findings/${t}`,{page:i,finding_state:s}).pipe((0,d.y)(r=>{console.log(r)}))}getWorkspaceWideSignals(e,t,s=1){return this.getRequest(`api/v1/devsecops/workspace/signals/${e}`,{page:s,finding_state:t}).pipe((0,d.y)(i=>{console.log(i)}))}getWorkspaceWideFindings(e,t,s=1){return this.getRequest(`api/v1/devsecops/workspace/findings/${e}`,{page:s,finding_state:t}).pipe((0,d.y)(i=>{console.log(i)}))}getProjectWideFindings(e,t,s,i=1){return this.getRequest(`api/v1/devsecops/project/${e}/findings/${t}`,{page:i,finding_state:s}).pipe((0,d.y)(r=>{console.log(r)}))}getOpenFindingsByAssessment(e,t,s=1){return this.getRequest(`api/v1/devsecops/engagement/${t}/${e}/findings`,{page:s}).pipe((0,d.y)(i=>{console.log(i)}))}getOpenFindingsByAssessmentStats(e){return this.getRequest(`api/v1/devsecops/engagement/${e}/findings/stats`,{}).pipe((0,p.k)(t=>t.data))}getOpenFindingsByAssessmentByFindingId(e,t){return this.getRequest(`api/v1/devsecops/engagement/${e}/findings/${t}`,{}).pipe((0,d.y)(s=>{console.log(s)}))}getAssessmentsFindings(e,t,s,i=1){return this.getRequest("api/v1/devsecops/beta_findings",{page:i,business_id:e,project_id:t,application_id:s}).pipe((0,d.y)(r=>{console.log(r)}))}getEngagementDetailsById(e,t,s,i,r=1){return this.getRequest(`api/v1/devsecops/engagement/details/${e}`).pipe((0,d.y)(a=>{console.log(a)}),(0,p.k)(a=>a?.data))}getFindingCategorisedCountStats(e,t){return this.getRequest("api/v1/devsecops/stats/finding",{category:t,...e}).pipe((0,p.k)(s=>s?.data))}getEngagementCategorisedCountStats(e,t){return this.getRequest("api/v1/devsecops/stats/engagement",{category:t,...e}).pipe((0,p.k)(s=>s?.data))}getEngagementStats(e,t){return this.getRequest("api/v1/devsecops/stats/engagement-history",{category:t,...e}).pipe((0,p.k)(s=>s?.data))}getEngagement(e,t,s,i,r,a=1){return this.getRequest("api/v1/devsecops/engagement",{category:e,page:a,business_id:t,project_id:s,application_id:i,engagement_state:r}).pipe((0,d.y)(n=>{console.log(n)}),(0,p.k)(n=>(n.data=n.data.map(o=>(o.primary_color=h(o.application_id.$oid),o)),n)))}getAssessments(e,t=1){return this.getRequest("api/v1/customer/assesment/history",{page:t}).pipe((0,d.y)(s=>{console.log(s)}))}getFindings(e,t,s,i,r,a){return this.postRequest("api/v1/devsecops/finding/fetch",{match:{refrence_ids:t,active:!0,severity:{$in:s}},sort:i},{offset:r,limit:a}).pipe((0,p.k)(n=>n?.data))}getFindingStats(e,t){return this.postRequest("api/v1/devsecops/getFindingStats",{refrence_ids:t,active:!0}).pipe((0,p.k)(s=>s?.data),(0,p.k)(s=>{let i={info:0,low:0,medium:0,high:0,critical:0};return s.forEach(r=>{i[r._id.toLowerCase()]=r.count}),i}))}getUserApplicationHierarchy(){return this.getRequest("api/v1/customer/getUserApplicationHierarchy")}setLoading(e){this.lastSubscription&&this.lastSubscription.unsubscribe();let t=0;e&&(t=0),this.lastSubscription=(0,k.of)(e).pipe((0,q.o)(t)).subscribe(()=>{this.loading.next(e)})}getRequest(e,t={},s={},i=null,r=!1){return this.http.get(`${this.localUrl}/${e}`,{params:t,headers:s,responseType:i})}deleteRequest(e,t={},s={},i=!1){return this.http.delete(`${this.localUrl}/${e}`,{params:t,headers:s})}postRequest(e,t={},s={},i=new v.UD,r=!1){return Object.keys(s).forEach(a=>void 0===s[a]&&delete s[a]),this.http.post(`${this.localUrl}/${e}`,t,{params:s,headers:i})}headRequest(e,t={},s=new v.UD,i=!1){return Object.keys(t).forEach(r=>void 0===t[r]&&delete t[r]),this.http.head(`${this.localUrl}/${e}`,{params:t,headers:s})}putRequest(e,t={},s={},i=new v.UD,r=!1){return Object.keys(s).forEach(a=>void 0===s[a]&&delete s[a]),this.http.put(`${this.localUrl}/${e}`,t,{params:s,headers:i})}init(){this.getUserApplication().pipe((0,d.y)(e=>{})).subscribe(e=>{this.getUserApplicationHierarchy().subscribe(t=>{let s={businessName:"All",title:"All",businessId:{$oid:"*"},_id:{$oid:"*"},project:[]};t=t?.data;let i=[],r=1;t.forEach(a=>{a?.project.forEach(n=>{let o=n?.businessId;n.businessId=o,n.projectId=n?._id,n.title=n?.name})}),s.project=i,t?.unshift(s),t.map(a=>(a.title=a?.businessName,a?.project.map((n,o)=>{let u=n?.businessId;n.index=o,n.businessId=u,n.projectId=n?._id,n.title=n?.name}),a?.project?.unshift({businessId:a?.businessId,projectId:{$oid:"*"},_id:{$oid:"*"},title:"All"}),a?.project.map((n,o)=>{if(n.index=o,o>0){let u=Object.assign({},n);u.index=r,r+=1,i.push(u)}}),a)),t.map((a,n)=>(a.index=n,a)),t?.length>0&&this.selectBusiness(0)})})}constructor(e,t,s){this.http=e,this.router=t,this.ngZone=s,this.mockDelay=x,this.fileList=[],this.buildTransformerPipe=i=>{let r=0,a=[{state:i?.state_requested,ts:i?.state_requested_ts,time_taken:0,title:"Enqueued"},{state:i?.state_execution,ts:i?.state_execution_ts,time_taken:0,title:"Executing"},{state:i?.state_download_raw,ts:i?.state_download_raw_ts,time_taken:0,title:"Report Generated"},{state:i?.state_pushed_to_parser,ts:i?.state_pushed_to_parser_ts,time_taken:0,title:"Analyzing"},{state:i?.state_parsing_started,ts:i?.state_parsing_started_ts,time_taken:0,title:"Parsing"},{state:i?.state_parsing_completed,ts:i?.state_parsing_completed_ts,time_taken:0,title:"Finished"}];return i.success=void 0,i.failed=!1,a.map((n,o)=>{if(0==o)return n;let u=a[o-1];return n.time_taken=n?.ts?.$date-u?.ts?.$date,n.time_taken=n?.time_taken/1e3,n.time_taken=0|n?.time_taken,n.time_taken=Math.ceil(n.time_taken),r+=n.time_taken,0==n?.state&&(i.failed=!0),n}),i.build_state=a,i.timeElpased=r,i.finding_stats=this.getFindingStats(i?.applicationId,i?._id).pipe(),i},this.selectedBuildId$=new b.g(void 0),this.selectedBuildId=this.selectedBuildId$.asObservable().pipe(),this.loading=new b.g(!1),this.localUrl=$.O.url,this.selectedBusiness$=new b.g(void 0),this.selectedBusiness=this.selectedBusiness$.asObservable().pipe(),this.selectedProject$=new b.g(void 0),this.selectedProject=this.selectedProject$.asObservable().pipe(),this.applicationList$=W.k.pipe((0,A.G)(i=>this.getUserApplication().pipe((0,p.k)(r=>r?.data)))),this.appHier$=this.getUserApplicationHierarchy().pipe((0,p.k)(i=>{let r={businessName:"All",title:"All",businessId:{$oid:"*"},_id:{$oid:"*"},project:[]};i=i?.data;let a=[],n=1;return i.forEach(o=>{o?.project.forEach(u=>{let m=u?.businessId;u.businessId=m,u.projectId=u?._id,u.title=u?.name})}),r.project=a,i?.unshift(r),i.map(o=>(o.title=o?.businessName,o?.project.map((u,m)=>{let g=u?.businessId;u.index=m,u.businessId=g,u.projectId=u?._id,u.title=u?.name}),o?.project?.unshift({businessId:o?.businessId,projectId:{$oid:"*"},_id:{$oid:"*"},title:"All"}),o?.project.map((u,m)=>{if(u.index=m,m>0){let g=Object.assign({},u);g.index=n,n+=1,a.push(g)}}),o)),i.map((o,u)=>(o.index=u,o)),console.debug("debug",i),i?.length>0&&this.selectBusiness(0),i})),this.appHier=this.appHier$.pipe((0,E.C)()),this.applicationList=this.applicationList$.pipe((0,E.C)()),this.applicationIntUnIntStats=this.applicationList.pipe((0,B.I)(i=>!!i),(0,p.k)(i=>{let r=0,a=0;return i.forEach(n=>{n.application.forEach(o=>{o?.scan_data?r+=1:a+=1})}),{integrated_apps_count:r,unintegrated_apps_count:a}})),this.selectedApp$=new b.g(void 0),this.selectedApp=this.selectedApp$.asObservable().pipe((0,B.I)(i=>!!i),(0,p.k)(i=>{if(null==i)return;i.identifier=i?.application?.applicationId?.$oid;let r=i?.platformName||"";return r=r.toLowerCase(),i.platformTag=r?.indexOf("web")>=0?"web":r?.indexOf("android")>=0||r?.indexOf("ios")>=0?"mobile":"unknown",i}),function M(l,f){return(0,L.a)((e,t)=>f?f(e[l],t[l]):e[l]===t[l])}("identifier")),this.applications=this.applicationList.pipe((0,d.y)(console.debug)),this._applications=this.selectedProject.pipe((0,B.I)(i=>!!i),(0,A.G)(i=>this.applicationList.pipe((0,p.k)(r=>r.filter(a=>{let n=a.platformId.$oid;return i?.platform?.filter(u=>"*"==u?.platformId?.$oid||u?.platformId?.$oid==n),!(a?.businessId?.$oid!=i?.businessId?.$oid&&"*"!=i?.businessId?.$oid||a?.projectId?.$oid!=i?.projectId?.$oid&&"*"!=i?.projectId?.$oid)})))),(0,p.k)(i=>{let r=[];return i.forEach(a=>{a?.application?.forEach(n=>{let o=Object.assign({},a);o.application=n,r.push(o)})}),r}),(0,E.C)())}getAutoSuggestions(e){return this.postRequest("api/v1/devsecops/getRepositoryData",e)}getAppToken(e){return this.getRequest(`api/v1/devsecops/application/${e}/integration/token`)}forceRebuild(e,t){return this.postRequest(`api/v1/devsecops/getBusinessHierarchy?token=${t}`,e)}getDevsecopsScanData(e){return this.postRequest("api/v1/devsecops/getDevsecopsScanData",e).pipe((0,p.k)(t=>t?.data))}getConfigureTools(e){return this.postRequest("api/v1/devsecops/configure_tools",e)}getMetaData(e){return this.getRequest("api/v1/devsecops/meta-data",e).pipe((0,p.k)(t=>t?.data))}setConfigureTools(e,t){return e.tools_config=t,this.putRequest("api/v1/devsecops/configure_tools",e)}addDevsecopsScanDetails(e,t){return this.postRequest("api/v1/devsecops/addScanDetails",{data:e,details:t})}getDevsecopsStaticScanData(e){return this.postRequest("api/v1/devsecops/getDevsecopsScanData/static",e).pipe((0,p.k)(t=>t?.data))}setDevsecopsActivationState(e,t){return this.postRequest("api/v1/devsecops/addScanDetails/configure",{data:e,details:{active_state:t}})}setDevsecopsConfigActivationFlag(e,t,s){let i={};return i[t]=s,this.postRequest("api/v1/devsecops/addScanDetails/configure",{data:e,details:i})}addDevsecopsStaticScanDetails(e,t){return this.postRequest("api/v1/devsecops/addScanDetails/static",{data:e,details:t})}getDevsecopsDynamicScanData(e){return this.postRequest("api/v1/devsecops/getDevsecopsScanData/dynamic",e).pipe((0,p.k)(t=>t?.data))}addDevsecopsDynamicScanDetails(e,t){return this.postRequest("api/v1/devsecops/addScanDetails/dynamic",{data:e,details:t})}downloadReportZip(e){return this.getRequest("api/v1/devsecops/getDevsecopsReport",e).pipe((0,p.k)(t=>t?.data?.url),(0,B.I)(t=>!!t),(0,d.y)(t=>{window.open($.O.minio_url+t,"_blank")}),(0,d.y)(t=>{}))}retry(e){return this.postRequest("api/v1/devsecops/retry",e)}lsremote(e){return this.postRequest("api/v1/devsecops/config/remote",{url:e})}healthcheck(e){return this.postRequest("api/v1/devsecops/config/healthCheck",{url:e}).pipe((0,p.k)(t=>({status_code:t?.data,status:t?.status})),(0,q.o)(this.mockDelay))}runRecon(e){return this.postRequest("api/v1/devsecops/runRecon",e)}runQuickDynamicScan(e){return this.postRequest("api/v1/devsecops/runQuickDynamicScan",e)}runScan(e){return this.postRequest("api/v1/devsecops/scm/run",{uuid:e})}updateBitbucketMapping(e){return this.postRequest("api/v1/devsecops/scm/accesscontrol",e)}getAllScmRepos(){return this.getRequest("api/v1/devsecops/scm/repository").pipe((0,p.k)(e=>e?.data))}getAllScmProjects(){return this.getRequest("api/v1/devsecops/scm/projects").pipe((0,p.k)(e=>e?.data))}getAllProjects(){return this.getRequest("api/v1/customer/getUserApplicationHierarchy").pipe((0,p.k)(e=>e?.data),(0,p.k)(e=>{let t=[];return e.forEach(s=>{s?.project?.map(i=>{let r=i;r.businessId=s?.businessId,r.businessName=s?.businessName,t.push(r)})}),t}))}scmIntegrationProgress(e,t){return this.getRequest(`api/v1/external/scm/${e}`,{code:t}).pipe()}getScmJobStatus(e,t){return this.getRequest(`api/v1/external/scm/${e}/${t}`).pipe()}getScmIntegrationList(e){return this.getRequest("api/v1/devsecops/scm/integrations",e).pipe((0,p.k)(t=>t?.data))}createScmCredentials(e,t){return this.postRequest(`api/v1/devsecops/scm/${e}/access-token`,t).pipe((0,p.k)(s=>s?.data))}updateScmCredentials(e,t,s){return this.putRequest(`api/v1/devsecops/scm/${e}/access-token/${t}`,s).pipe((0,p.k)(i=>i?.data))}syncScmCredentialsAssets(e){return this.postRequest(`api/v1/devsecops/scm/sync/${e}`).pipe((0,p.k)(t=>t?.data))}getScmAppPassword(e,t){return this.getRequest(`api/v1/devsecops/scm/${e}/access-token`,t).pipe((0,p.k)(s=>s?.data))}getScmIntegrations(e){return this.getRequest("api/v1/devsecops/scm/access-token",e).pipe((0,p.k)(t=>t?.data))}getScmRepos(e,t){return this.postRequest("api/v1/devsecops/scm/repositories",t,e).pipe()}getWebappsIntegrations(e){return this.getRequest("api/v1/devsecops/webapp/integrations",e).pipe((0,p.k)(t=>(t.data=t.data.map(s=>s),t)))}getInstalleddAgentList(e){return this.getRequest(`api/v1/devsecops/install-agent/${e}`).pipe((0,p.k)(t=>t?.data))}getAllInstalleddAgentList(){return this.getRequest("api/v1/devsecops/install-agent").pipe((0,p.k)(e=>e?.data))}updateInstalleddAgentList(e,t){return this.postRequest(`api/v1/devsecops/install-agent/${e}`,t)}createInstalleddAgentList(e){return this.postRequest("api/v1/devsecops/install-agent",e)}getAgent(e){return this.getRequest(`secoflex/agent/${e}`).pipe()}getAgentJobs(e,t){return this.getRequest(`secoflex/agent/jobs/${e}`,t).pipe()}getAssetJobs(e){return this.getRequest("secoflex/asset/jobs",e).pipe()}getWorkers(e){return this.getRequest("secoflex/workers",{agent_id:e}).pipe()}importAgentJobResult(e,t){return this.getRequest(`api/v1/devsecops/secoflex/import/${e}`,t).pipe()}getAgentJobResult(e,t){return this.getRequest(`secoflex/agent/jobs/${e}/results`,t).pipe()}getAgentList(e){return this.getRequest("secoflex/agents",e).pipe()}executeAgent(e,t){return this.postRequest(`secoflex/agent/${e}`,t).pipe()}getAgentTaskFiltered(e){return this.postRequest("secoflex/agnet-tasks",e).pipe()}getSelectedAssets(e,t){return this.postRequest("dryrun.secoflex/agent",t,e).pipe()}executeAgents(e,t){return this.putRequest("secoflex/agent",t,e).pipe()}downloadAgentResult(e,t){return this.getRequest(`secoflex/agent/jobs/${e}/results/download`,t,{},"blob")}getRepoDetails(e){return this.getRequest(`api/v1/devsecops/scm/repositories/${e}`).pipe((0,p.k)(t=>t?.data))}getRepoBranchesDetails(e){return this.getRequest(`api/v1/devsecops/scm/repositories/${e}/branches`).pipe((0,p.k)(t=>t?.data))}setRepoBranchesDetails(e,t){return this.putRequest(`api/v1/devsecops/scm/repositories/${e}/branches`,{selected_branch:t}).pipe((0,p.k)(s=>s?.status))}testWatchdog(e){return this.postRequest("api/v1/devsecops/test-watchedog",e).pipe()}downloadFile(e){return this.getRequest("api/v1/external_tools/getPresignedUrl",{bucketName:e.bucket,filename:e.filename,path:e.path}).pipe((0,p.k)(s=>s?.data))}downloadFileDirectly(e){return this.getRequest("api/v1/devsecops/download",{bucket:e.bucket,filename:e.filename,path:e.path}).pipe((0,p.k)(s=>s?.data))}downloadAppArtifact(e,t){return this.getRequest(`api/v1/devsecops/download/app/artifact/${t}/${e}`).pipe((0,p.k)(s=>{if(1==s.status){let i=$.O.minio_url+s.data.url;console.log("minio_url",i),window.open(i,"_blank")}}))}getAssociatedBusinesses(){return this.getRequest("api/v1/business/?limit=9999999999").pipe((0,p.k)(e=>e.data))}getAssociatedBusinessesProjects(){return this.getRequest("api/v1/project").pipe((0,p.k)(e=>e.data))}getAssociatedBusinessesByProjectId(e){return this.getRequest("api/v1/business/"+e).pipe((0,p.k)(t=>t.data?.projects))}debugModifyEngagementState(e,t){return this.putRequest(`api/v1/devsecops/debug/engagement/${e}/state/${t}`).pipe((0,p.k)(s=>s?.data))}getAccounts(){return this.getRequest("api/v1/devsecops/account").pipe((0,p.k)(e=>(e.data=e.data.map(t=>(t.primary_color=h(t._id.$oid),t)),e)),(0,p.k)(e=>e?.data))}createAccount(e,t){return this.postRequest("api/v1/devsecops/account",{name:e,description:t}).pipe()}editAccount(e,t){return this.putRequest(`api/v1/devsecops/account/${e}`,t).pipe()}createProject(e,t,s){return this.postRequest(`api/v1/devsecops/account/${e}/projects`,{name:t,description:s}).pipe()}updateProject(e,t){return this.putRequest(`api/v1/devsecops/account/${e}/projects/${e}`,t).pipe()}addUserToAccount(e,t){return this.putRequest(`api/v1/devsecops/account/${t}/user/${e}`).pipe((0,p.k)(s=>s?.status))}addUserRole(e,t){return this.putRequest(`api/v1/devsecops/team/${e}/role/${t}`).pipe()}addUserToTeam(e){return this.postRequest(`api/v1/devsecops/team/${e}`).pipe((0,p.k)(t=>t?.status))}removeUserRole(e,t){return this.deleteRequest(`api/v1/devsecops/team/${e}/role/${t}`).pipe()}removeAllAccessUserRole(e){return this.deleteRequest(`api/v1/devsecops/team/${e}/role`).pipe()}deleteUserFromAccount(e,t){return this.deleteRequest(`api/v1/devsecops/account/${t}/user/${e}`).pipe((0,p.k)(s=>s?.status))}getProjectsInAccount(e){return this.getRequest(`api/v1/devsecops/account/${e}/projects`).pipe((0,p.k)(t=>(t.data=t.data.map(s=>(s.primary_color=h(s._id.$oid),s)),t)),(0,p.k)(t=>t?.data))}getMyProfileInWorkspaceContext(){return this.getRequest("api/v1/devsecops/me").pipe((0,p.k)(e=>(e.data.primary_color=h(e.data.email),e)))}updateMyProfileInWorkspaceContext(e){return this.putRequest("api/v1/devsecops/me",e).pipe()}getUserDetails(e){return this.getRequest(`api/v1/devsecops/user/details/${e}`).pipe((0,p.k)(t=>(t.data.primary_color=h(t.data.email),t)))}createWorkspace(e){return this.postRequest("api/v1/devsecops/workspace",{title:e})}getWorkspaceSelf(){return this.getRequest("api/v1/devsecops/self/workspace").pipe()}getWorkspacesSelf(){return this.getRequest("api/v1/devsecops/self/workspaces").pipe()}getWorkspaces(){return this.getRequest("api/v1/devsecops/workspace").pipe()}getWorkspace(e){return this.getRequest(`api/v1/devsecops/workspace/${e}`).pipe((0,p.k)(t=>t.data),(0,p.k)(t=>(t.admin=t?.admin.map(s=>((s={email:s}).primary_color=h(s.email),s.text_color=I(s.primary_color),s)),t.user=t?.user.map(s=>((s={email:s}).primary_color=h(s.email),s.text_color=I(s.primary_color),s)),t)))}getWorkspaceAccess(e){return this.getRequest(`api/v1/devsecops/workspace/access/${e}`).pipe()}updateSelfWorkspace(e){return this.putRequest("api/v1/devsecops/self/workspace",e)}updateWorkspace(e,t){return this.putRequest(`api/v1/devsecops/workspace/${e}`,t)}addAdminToWorkspace(e,t){return this.putRequest(`api/v1/devsecops/workspace/${e}/admin/${t}`)}removeAdminToWorkspace(e,t){return this.deleteRequest(`api/v1/devsecops/workspace/${e}/admin/${t}`)}addUserToWorkspace(e,t){return this.putRequest(`api/v1/devsecops/workspace/${e}/user/${t}`)}removeUserToWorkspace(e,t){return this.deleteRequest(`api/v1/devsecops/workspace/${e}/user/${t}`)}unpublishActivityJobPublish(e,t){return this.deleteRequest(`api/v1/devsecops/engagement/${e}/activity/${t}/job-publish`).pipe()}publishActivityJobPublish(e,t){return this.putRequest(`api/v1/devsecops/engagement/${e}/activity/${t}/job-publish`).pipe()}getActivitiesForEngagement(e){return this.getRequest(`api/v1/devsecops/engagement/${e}/activity`).pipe((0,p.k)(t=>t?.data),(0,p.k)(t=>t.map(s=>(s.primary_color=h(s._id.$oid),s.text_color=I(s.primary_color),s))))}uploadActivityReport(e,t){return new v.UD,this.http.post(this.localUrl+"/api/v1/devsecops/upload",{files:[{filename:e.name}]}).pipe((0,A.G)(r=>{let a=r.files[0];return this.http.put($.O.minio_url+a.presigned_url,e,{reportProgress:!0,observe:"events",withCredentials:!0}).pipe(this.uploadProgressPipeAndLinker(a))}),(0,d.y)(r=>{console.log("major task done",r)})).pipe((0,w.W)({progress:1,completed:!1,init:!0}))}createEngagementActivity(e,t){return this.postRequest(`api/v1/devsecops/engagement/${e}/activity`,t).pipe()}getActivityDetails(e,t){return this.getRequest(`api/v1/devsecops/engagement/${e}/activity/${t}`).pipe((0,p.k)(s=>s?.data))}getActivityParsedFindings(e,t){return this.getRequest(`api/v1/devsecops/engagement/${e}/activity/${t}/finding`).pipe((0,p.k)(s=>s?.data))}getActivityParsedFindingById(e,t,s){return this.getRequest(`api/v1/devsecops/engagement/${t}/activity/${s}/finding/${e}`).pipe()}getFqdnList(e){return this.getRequest("api/v1/devsecops/fqdn",e).pipe()}postFqdnList(e){return this.postRequest("api/v1/devsecops/fqdn",e).pipe()}_triggerScanParseActivity(e,t,s=0){return this.getRequest(`api/v1/devsecops/internal/parser/consume/${e}/${t}`)}triggerScanParseActivity(e){return this.postRequest(`api/v1/messagebus/publish/activity/parse/${e}`)}downloadActivityReport(e,t,s=0){return this.getRequest(`api/v1/devsecops/engagement/${e}/activity/${t}/download`,{file_index:s}).pipe((0,p.k)(i=>{if(1==i.status){let r=$.O.minio_url+i.data.url;console.log("minio_url",r),window.open(r,"_blank")}}))}static{this.\u0275fac=function(t){return new(t||l)(D.CoB(v.KK),D.CoB(H.E5),D.CoB(D.WW2))}}static{this.\u0275prov=D.wxM({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()}}]);